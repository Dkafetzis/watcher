<!DOCTYPE html>
<html lang="en">
    {@io.universe.entities.comicvine.ComicVineVolume comicVineVolume}
    {@java.util.List<io.universe.entities.comicvine.ComicVineVolume> volumeList}
    {@java.lang.Integer offset}
    {@java.lang.Integer pageCount}
    {@java.lang.Integer totalCount}
    {@java.lang.String query}
    {@java.lang.Integer limit}
    {@java.lang.Integer currentPage}
    {@java.lang.Integer totalPages}
    {@java.util.List<java.lang.Integer> pageWindow}
    {@java.lang.Integer lastOffset}
    {@java.util.List<java.lang.Integer> pageOffsets}

    {#include header /}
    {#include menuBar/}
    <body hx-boost="true">
        <div class="panel-container">
            {#include pageCounter offset pageCount totalCount query limit currentPage totalPages lastOffset pageWindow pageOffsets /}
            <h1><i class="fas fa-user icon"></i> Results</h1>

            <div class="table-wrapper">
                <table class="styled-table">
                    <thead>
                    <tr>
                        <th><label>
                            <input type="checkbox">
                        </label></th>
                        <th>Comic Name</th>
                        <th>Publisher</th>
                        <th>Year</th>
                        <th>Issues</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    {#for comicVineVolume in volumeList}
                    <tr>
                        <td><label>
                            <input type="checkbox">
                        </label></td>
                        <td><a href="{comicVineVolume.site_detail_url}" target="_blank">{comicVineVolume.name ?: "No name found"}</a></td>
                        <td>{comicVineVolume.publisher.name ?: "No publisher found"}</td>
                        <td>{comicVineVolume.start_year ?: "No year found"}</td>
                        <td>{comicVineVolume.count_of_issues ?: "No number of issues"}</td>
                        <td>
                            {#if comic:isAdded(comicVineVolume.id)}
                                <button disabled>Already added</button>
                            {#else}
                                <button hx-target="this"
                                        hx-swap="outerHTML"
                                        hx-post="/api/comic?id={comicVineVolume.id}&name={comicVineVolume.name}&year={comicVineVolume.start_year}"
                                        hx-indicator="#spinner-{comicVineVolume.id}"
                                        hx-trigger="click once">
                                    Add Comic
                                    <img  id="spinner-{comicVineVolume.id}"

                                          class="spinner-indicator"
                                          src="/spinner.svg"
                                          alt="Loading..."/>
                                </button>
                            {/if}</td>
                    </tr>
                    {/for}
                </table>
            </div>
            {#include pageCounter offset pageCount totalCount query limit currentPage totalPages lastOffset pageWindow pageOffsets /}
        </div>
    </body>
</html>